import { inject, injectable } from "tsyringe";
import { Vulnerability } from "../entity/Vulnerability";
import { ICreateVulnerabilityDTO, IVulnerabilityRepository } from "../repositories/IVulnerabilityRepository";

@injectable()
class IndexVulnerabilityService {
  constructor(
    @inject('VulnerabilityRepository')
    private vulnerabilityRepository: IVulnerabilityRepository) { }

  async execute(): Promise<Vulnerability[]> {
    const vulnerabilitys = await this.vulnerabilityRepository.index();
    
    return vulnerabilitys;
  }
}

export { IndexVulnerabilityService };
