import { inject, injectable } from "tsyringe";
import { Vulnerability } from "../entity/Vulnerability";
import { ICreateVulnerabilityDTO, IVulnerabilityRepository } from "../repositories/IVulnerabilityRepository";

@injectable()
class CreateVulnerabilityService {
  constructor(
    @inject('VulnerabilityRepository')
    private vulnerabilityRepository: IVulnerabilityRepository) { }

  async execute(data: ICreateVulnerabilityDTO): Promise<Vulnerability> {
    const vulnerability = await this.vulnerabilityRepository.create(data);
    
    return vulnerability;
  }
}

export { CreateVulnerabilityService };
